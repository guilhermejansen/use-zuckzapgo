# .env

LICENSE_KEY=SEU_LICENSE_KEY_AQUI
INSTANCE_ID=
# IP p√∫blico utilizado em integra√ß√µes externas (opcional)
SERVER_IP=

# Informa√ß√µes adicionais de ambiente para monitoramento/healthcheck
APP_ENV=production
APP_REGION=sa-east-1
GIT_COMMIT=local-build
# Chaves contendo "-ENT-" liberam recursos avan√ßados (carrossel, bot√µes interativos, flow).
# Para solicitar upgrade Enterprise, entre em contato com o suporte ZuckZapGo.

# Env Docker
# ZUCKZAPGO_ADDRESS: Define o endere√ßo base para a API ZuckZapGo
# Esta URL ser√° inclu√≠da em TODOS os eventos (webhook + RabbitMQ)
# tanto globais quanto individuais, permitindo que sistemas externos
# saibam exatamente de onde o evento est√° vindo
ZUCKZAPGO_ADDRESS=https://api.example.com
ZUCKZAPGO_PORT=8080

# =================== CONFIGURA√á√ïES DE DEBUG ===================
# üìà Controle geral de logs da aplica√ß√£o (resolve logs DEBUG)
# Valores: debug, info, warn, error (em min√∫sculo)
ZUCKZAPGO_LOG_LEVEL=info

# üêõ Debug espec√≠fico do WhatsApp (biblioteca whatsmeow)
# Valores: info, debug ou vazio (em min√∫sculo)
ZUCKZAPGO_DEBUG=info
LOG_TYPE=console
LOG_COLOR=true

# Token for zuckzapgo Admin
ZUCKZAPGO_ADMIN_TOKEN=SEU_ADMIN_TOKEN_AQUI_ADMIN_TOKEN_AQUI

# zuckzapgo Session Configuration
SESSION_DEVICE_NAME=zuckzapgo

TZ=America/Sao_Paulo

# ========== CONFIGURA√á√ïES PADR√ÉO DE DISPOSITIVO WHATSAPP ==========
# ========================================
# NOTAS IMPORTANTES
# ========================================
#
# 1. TODAS as configura√ß√µes s√£o OPCIONAIS
# 2. Se n√£o configuradas, usa padr√µes da whatsmeow
# 3. Configura√ß√µes por usu√°rio sobrep√µem globais
# 4. Configura√ß√µes aplicadas ANTES da conex√£o WhatsApp
# 5. Para alterar configura√ß√µes existentes, desconecte e reconecte o usu√°rio
# 6. Valores inv√°lidos usam padr√µes com log de aviso
#
# ========================================
# VALORES V√ÅLIDOS POR CAMPO
# ========================================
#
# waPlatform:
# ANDROID, IOS, WINDOWS_PHONE, BLACKBERRY, BLACKBERRYX, S40, S60,
# PYTHON_CLIENT, TIZEN, ENTERPRISE, SMB_ANDROID, KAIOS, SMB_IOS,
# WINDOWS, WEB, PORTAL, GREEN_ANDROID, GREEN_IPHONE, BLUE_ANDROID,
# BLUE_IPHONE, FBLITE_ANDROID, MLITE_ANDROID, IGLITE_ANDROID, PAGE,
# MACOS, OCULUS_MSG, OCULUS_CALL, MILAN, CAPI, WEAROS, ARDEVICE,
# VRDEVICE, BLUE_WEB, IPAD, TEST, SMART_GLASSES, BLUE_VR
#
# waReleaseChannel:
# RELEASE, BETA, ALPHA, DEBUG
#
# waWebSubPlatform:
# WEB_BROWSER, APP_STORE, WIN_STORE, DARWIN, WIN32, WIN_HYBRID
#
# waConnectType:
# CELLULAR_UNKNOWN, WIFI_UNKNOWN, CELLULAR_EDGE, CELLULAR_IDEN,
# CELLULAR_UMTS, CELLULAR_EVDO, CELLULAR_GPRS, CELLULAR_HSDPA,
# CELLULAR_HSUPA, CELLULAR_HSPA, CELLULAR_CDMA, CELLULAR_1XRTT,
# CELLULAR_EHRPD, CELLULAR_LTE, CELLULAR_HSPAP
#
# waPlatformType:
# UNKNOWN, CHROME, FIREFOX, IE, OPERA, SAFARI, EDGE, DESKTOP, IPAD,
# ANDROID_TABLET, OHANA, ALOHA, CATALINA, TCL_TV, IOS_PHONE,
# IOS_CATALYST, ANDROID_PHONE, ANDROID_AMBIGUOUS, WEAR_OS, AR_WRIST,
# AR_DEVICE, UWP, VR, CLOUD_API, SMARTGLASSES

# Este arquivo mostra como configurar as op√ß√µes avan√ßadas do WhatsApp
# atrav√©s de vari√°veis de ambiente (globais) ou via API (por usu√°rio).
#
# IMPORTANTE: Estas configura√ß√µes s√£o OPCIONAIS. Se n√£o definidas,
# o ZuckZapGo usa os padr√µes da biblioteca whatsmeow.

# ========================================
# CONFIGURA√á√ïES GLOBAIS (Vari√°veis de Ambiente)
# ========================================
# Aplicam-se a TODOS os usu√°rios se n√£o configuradas individualmente

# Vers√£o do WhatsApp Web (formato: primary.secondary.tertiary)
# WA_VERSION=2.3000.1028259376

# Plataforma do dispositivo
# Op√ß√µes: WEB, ANDROID, IOS, WINDOWS, MACOS, IPAD, etc.
# WA_PLATFORM=WEB

# Canal de release
# Op√ß√µes: RELEASE, BETA, ALPHA, DEBUG
# WA_RELEASE_CHANNEL=RELEASE

# Sub-plataforma para Web
# Op√ß√µes: WEB_BROWSER, APP_STORE, WIN_STORE, DARWIN, WIN32, WIN_HYBRID
# WA_WEB_SUB_PLATFORM=WEB_BROWSER

# Sistema operacional
# WA_OS_NAME=Mac OS
# WA_OS_VERSION=10.15.7

# Informa√ß√µes do dispositivo
# WA_DEVICE_NAME=SAFARI
# WA_MANUFACTURER=Apple
# WA_DEVICE_BOARD=

# Configura√ß√µes de localiza√ß√£o
# WA_LOCALE_LANGUAGE=en
# WA_LOCALE_COUNTRY=US

# C√≥digos de rede m√≥vel
# WA_MCC=000
# WA_MNC=000

# Tipo de conex√£o
# Op√ß√µes: WIFI_UNKNOWN, CELLULAR_UNKNOWN, CELLULAR_LTE, etc.
# WA_CONNECT_TYPE=WIFI_UNKNOWN

# Tipo de plataforma para DeviceProps
# Op√ß√µes: DESKTOP, CHROME, FIREFOX, SAFARI, EDGE, IPAD, etc.
# WA_PLATFORM_TYPE=SAFARI

# =================== WEBHOOK INDIVIDUAL POR INSTANICA CONFIGURATIONS ===================
# These settings act as per-user defaults when users don't override them via API
# "json" or "form" for the default
WEBHOOK_FORMAT=json

# Timeout principal da requisi√ß√£o HTTP
WEBHOOK_TIMEOUT=30s

# N√∫mero m√°ximo de tentativas de retry
WEBHOOK_MAX_RETRIES=3

# Delay inicial entre tentativas
WEBHOOK_RETRY_DELAY=2s

# Delay m√°ximo entre tentativas (cap do backoff exponencial)
WEBHOOK_MAX_RETRY_DELAY=30s

# Fator de multiplica√ß√£o para backoff exponencial
WEBHOOK_BACKOFF_FACTOR=2.0

# N√∫mero m√°ximo de requisi√ß√µes simult√¢neas
WEBHOOK_MAX_CONCURRENCY=100

DB_TYPE=sqlite

# Database configuration
# DATABASE_URL=mysql://zuckzapgo:zuckzapgo@localhost:3306/zuckzapgo?charset=utf8mb4&parseTime=True&loc=Local
# DATABASE_URL=postgres://zuckzapgo:zuckzapgo@localhost:5432/zuckzapgo?sslmode=disable&search_path=public

# DB_USER=zuckzapgo
# DB_PASSWORD=zuckzapgo
# DB_NAME=zuckzapgo
# DB_HOST=localhost
# DB_PORT=5432
# DB_SSLMODE=disable
# DB_SCHEMA=public

# =================== POSTGRESQL CONNECTION POOL (ALTA CARGA) ===================
# Configura√ß√µes do pool de conex√µes PostgreSQL otimizadas para cen√°rios de alta carga
# (800+ inst√¢ncias WhatsApp). Ajuste conforme recursos dispon√≠veis e uso de PgBouncer.
# DB_MAX_OPEN_CONNS: M√°ximo de conex√µes abertas simult√¢neas no pool
DB_MAX_OPEN_CONNS=200
# DB_MAX_IDLE_CONNS: M√°ximo de conex√µes ociosas mantidas no pool (recomendado ~30-40% do max_open)
DB_MAX_IDLE_CONNS=75
# DB_CONN_MAX_LIFETIME_MINUTES: Tempo m√°ximo de vida de uma conex√£o antes de ser reciclada
DB_CONN_MAX_LIFETIME_MINUTES=30
# DB_CONN_MAX_IDLE_TIME_MINUTES: Tempo m√°ximo que uma conex√£o pode ficar ociosa antes de ser fechada
DB_CONN_MAX_IDLE_TIME_MINUTES=5

# =================== STARTUP E WATCHDOG (ALTA CARGA) ===================
# Configura√ß√µes para inicializa√ß√£o controlada e monitoramento de clientes WhatsApp
# Evita thundering herd e reduz picos de CPU durante o startup
# STARTUP_BATCH_SIZE: Quantidade de clientes WhatsApp iniciados por lote
STARTUP_BATCH_SIZE=50
# STARTUP_BATCH_DELAY_MS: Delay em milissegundos entre lotes de inicializa√ß√£o
STARTUP_BATCH_DELAY_MS=2000
# WATCHDOG_INTERVAL_SECONDS: Intervalo do watchdog para verificar sa√∫de dos clientes (default: 300 = 5 minutos)
WATCHDOG_INTERVAL_SECONDS=300

# =================== GLOBAL SKIP CONFIGURATIONS ===================
# Skip media download globally for all users
GLOBAL_SKIP_MEDIA_DOWNLOAD=false
# Skip events from WhatsApp groups
GLOBAL_SKIP_GROUPS=false
# Skip events from WhatsApp newsletters
GLOBAL_SKIP_NEWSLETTERS=false
# Skip events from WhatsApp broadcasts and status updates
GLOBAL_SKIP_BROADCASTS=false
# Skip user's own messages (sent messages)
GLOBAL_SKIP_OWN_MESSAGES=false
# Skip call events (offers, accepts, terminates)
GLOBAL_SKIP_CALLS=false
# Global default message for call rejection (default: 'Sorry, I cannot take calls at the moment.')
GLOBAL_CALL_REJECT_MESSAGE=Sorry, I cannot take calls at the moment.
# Global default call rejection type: 'busy', 'decline', or 'unavailable' (default: 'busy')
GLOBAL_CALL_REJECT_TYPE=busy
# Enable/disable echo API messages (emits Message events for API sends when enabled)
ECHO_API_MESSAGES_ENABLED=false

# =================== GLOBAL S3 CONFIGURATION ===================
# Enable/disable global S3 for media processing
GLOBAL_S3_ENABLED=false
# S3 endpoint (leave empty for AWS S3)
GLOBAL_S3_ENDPOINT=https://s3.example.com
# S3 region
GLOBAL_S3_REGION=us-east-1
# S3 bucket name for global media
GLOBAL_S3_BUCKET=zuckzapgo
# S3 access key
GLOBAL_S3_ACCESS_KEY=
# S3 secret key
GLOBAL_S3_SECRET_KEY=
# Use path-style URLs (true for MinIO/compatible)
GLOBAL_S3_PATH_STYLE=true
# Custom public URL for S3 objects (optional)
GLOBAL_S3_PUBLIC_URL=https://s3.example.com
# Media delivery method: base64, url, or both
GLOBAL_S3_MEDIA_DELIVERY=url
# Retention days for media (0 = no expiration)
GLOBAL_S3_RETENTION_DAYS=1
# S3 ACL Configuration
# Set to true for AWS S3 buckets with "Bucket owner enforced" Object Ownership
# Set to false for legacy buckets or other S3-compatible providers that support ACLs
GLOBAL_S3_DISABLE_ACL=true

# =================== S3 RETENTION CLEANUP CONFIGURATION ===================
# Sistema de limpeza autom√°tica de objetos S3 expirados baseado em s3_retention_days de cada usu√°rio
# O worker GLOBAL processa todos os usu√°rios com s3_enabled=true E s3_retention_days > 0
# Cada usu√°rio mant√©m sua pr√≥pria configura√ß√£o de reten√ß√£o (individual)

# Enable/disable S3 retention cleanup worker
S3_RETENTION_ENABLED=true
# Interval between cleanup cycles (default: 1h)
S3_RETENTION_INTERVAL=1h
# Maximum users processed in parallel (default: 5)
S3_RETENTION_MAX_CONCURRENCY=5
# Objects per S3 batch delete request (max: 1000, AWS limit)
S3_RETENTION_BATCH_SIZE=1000
# Maximum objects to process per user per cycle (default: 10000)
S3_RETENTION_OBJECTS_PER_CYCLE=10000
# Timeout for cleanup operation per user (default: 10m)
S3_RETENTION_OPERATION_TIMEOUT=10m

# =================== GLOBAL SQS CONFIGURATION ===================
# Enable/disable SQS transport fan-out
GLOBAL_SQS_ENABLED=false
# AWS region where the queue lives
GLOBAL_SQS_REGION=us-east-1
# Full queue URL (https://sqs.us-east-1.amazonaws.com/123456789012/zuckzapgo-global)
GLOBAL_SQS_QUEUE_URL=
# Optional AWS profile (useful for local development)
GLOBAL_SQS_PROFILE=
# AWS credentials (leave empty to rely on IAM/ECS roles)
GLOBAL_SQS_ACCESS_KEY=
GLOBAL_SQS_SECRET_KEY=
GLOBAL_SQS_SESSION_TOKEN=
# Custom endpoint (LocalStack/third-party)
GLOBAL_SQS_ENDPOINT=
# Enable FIFO queue mode
GLOBAL_SQS_FIFO=false
# Message group ID for FIFO queues
GLOBAL_SQS_MESSAGE_GROUP=zuckzapgo-global
# Delivery delay applied to every message (seconds)
GLOBAL_SQS_DELAY_SECONDS=0
# Events delivered to SQS (comma separated or All)
GLOBAL_SQS_EVENTS=All
# Retry controls
GLOBAL_SQS_TIMEOUT=5s
GLOBAL_SQS_RETRY_DELAY=750ms
GLOBAL_SQS_MAX_RETRIES=3

# =================== GLOBAL REDIS STREAMS CONFIGURATION ===================
GLOBAL_REDIS_ENABLED=false
GLOBAL_REDIS_ADDRESS=localhost:6379
GLOBAL_REDIS_USERNAME=
GLOBAL_REDIS_PASSWORD=
GLOBAL_REDIS_TLS=false
GLOBAL_REDIS_STREAM=zuckzapgo.events
GLOBAL_REDIS_EVENTS=All
GLOBAL_REDIS_MAXLEN=100000
GLOBAL_REDIS_TRIM_APPROX=true
GLOBAL_REDIS_TIMEOUT=2s
GLOBAL_REDIS_RETRY_DELAY=500ms
GLOBAL_REDIS_MAX_RETRIES=3

# =================== GLOBAL WEBSOCKET CONFIGURATION ===================
GLOBAL_WEBSOCKET_ENABLED=false
# Comma separated list of ws:// or wss:// endpoints
GLOBAL_WEBSOCKET_ENDPOINTS=
GLOBAL_WEBSOCKET_EVENTS=All
GLOBAL_WEBSOCKET_ENABLE_COMPRESSION=true
GLOBAL_WEBSOCKET_HEADERS=
GLOBAL_WEBSOCKET_TIMEOUT=10s
GLOBAL_WEBSOCKET_WRITE_TIMEOUT=5s
GLOBAL_WEBSOCKET_RETRY_DELAY=2s
GLOBAL_WEBSOCKET_MAX_RETRIES=5

# Enable global webhook
GLOBAL_WEBHOOK_ENABLED=false
GLOBAL_WEBHOOK_URL=https://api.example.com/webhook/debug-zuckzapgo

# Event filtering (comma-separated or "All")
GLOBAL_WEBHOOK_EVENTS=All

# Performance tuning
GLOBAL_WEBHOOK_TIMEOUT=30s
GLOBAL_WEBHOOK_RETRY_COUNT=3
GLOBAL_WEBHOOK_RETRY_DELAY=2s
GLOBAL_WEBHOOK_MAX_RETRY_DELAY=30s
GLOBAL_WEBHOOK_BACKOFF_FACTOR=2.0
GLOBAL_WEBHOOK_CONCURRENCY=50

# Enable global RabbitMQ
GLOBAL_RABBITMQ_ENABLED=false
GLOBAL_RABBITMQ_URL=amqp://zuckzapgo:zuckzapgo@localhost:5672/zuckzapgo

# Event filtering (comma-separated or "All")
GLOBAL_RABBITMQ_EVENTS=All

# Exchange and queue settings
GLOBAL_RABBITMQ_EXCHANGE=zuckzapgo.global
GLOBAL_RABBITMQ_EXCHANGE_TYPE=topic

# ===== OP√á√ÉO 1: FILA √öNICA (EXEMPLO) =====
# Mant√©m uma fila √∫nica compartilhada. O curinga `#` entrega TODOS os eventos
# publicados nesse exchange para a fila. Descomente apenas quando broadcast total
# for realmente desejado.
# GLOBAL_RABBITMQ_QUEUE=zuckzapgo.events
# GLOBAL_RABBITMQ_ROUTING_KEY=events.#

# ===== OP√á√ÉO 2: FILAS POR EVENTO (NOVO) =====
# Cria filas separadas por tipo de evento. O placeholder `{event_type}` deve
# aparecer tanto no nome da fila quanto na routing key para evitar broadcast.
# Recomendado incluir `{user_id}` nos dois casos quando o isolamento for
# necess√°rio: queue `zuckzapgo_{user_id}_{event_type}_events` com routing key
# `events.{user_id}.{event_type}`.
GLOBAL_RABBITMQ_QUEUE=zuckzapgo_{user_id}_{event_type}_events
GLOBAL_RABBITMQ_ROUTING_KEY=events.{user_id}.{event_type}
GLOBAL_RABBITMQ_QUEUE_TYPE=classic

GLOBAL_RABBITMQ_DURABLE=true
GLOBAL_RABBITMQ_AUTO_DELETE=false
GLOBAL_RABBITMQ_EXCLUSIVE=false
GLOBAL_RABBITMQ_NO_WAIT=false
GLOBAL_RABBITMQ_DELIVERY_MODE=2

GLOBAL_RABBITMQ_CONNECTION_POOL_SIZE=50
GLOBAL_RABBITMQ_WORKER_COUNT=100
GLOBAL_RABBITMQ_QUEUE_BUFFER_SIZE=100000
GLOBAL_RABBITMQ_ENABLE_BATCHING=true
GLOBAL_RABBITMQ_BATCH_SIZE=1000
GLOBAL_RABBITMQ_BATCH_TIMEOUT_MS=100
GLOBAL_RABBITMQ_CIRCUIT_BREAKER_THRESHOLD=20
GLOBAL_RABBITMQ_CIRCUIT_BREAKER_TIMEOUT_S=60
GLOBAL_RABBITMQ_PUBLISH_TIMEOUT_MS=5000
GLOBAL_RABBITMQ_MAX_RETRIES=5
GLOBAL_RABBITMQ_RETRY_DELAY_MS=500
GLOBAL_RABBITMQ_METRICS_INTERVAL_S=10
GLOBAL_RABBITMQ_ENABLE_DETAILED_LOGS=false
GLOBAL_RABBITMQ_ENABLE_METRICS_LOG=true
GLOBAL_RABBITMQ_QOS_PREFETCH_COUNT=100
GLOBAL_RABBITMQ_MANDATORY=false
GLOBAL_RABBITMQ_IMMEDIATE=false
GLOBAL_RABBITMQ_ENABLE_COMPRESSION=false
GLOBAL_RABBITMQ_ENABLE_PERSISTENCE=true
GLOBAL_RABBITMQ_ENABLE_CONFIRMATION=true

# ===== ARGUMENTOS AVAN√áADOS DE FILA E EXCHANGE =====
# Configura√ß√µes de Dead Letter (mensagens rejeitadas/expiradas v√£o para DLQ)
# GLOBAL_RABBITMQ_DEAD_LETTER_EXCHANGE=dlx.zuckzapgo
# GLOBAL_RABBITMQ_DEAD_LETTER_ROUTING_KEY=dlq.events

# Limites de fila (controle de overflow)
# GLOBAL_RABBITMQ_MESSAGE_TTL=86400000           # TTL em milissegundos (86400000 = 24h)
# GLOBAL_RABBITMQ_MAX_LENGTH=100000              # N√∫mero m√°ximo de mensagens na fila
# GLOBAL_RABBITMQ_MAX_LENGTH_BYTES=104857600     # Tamanho m√°ximo em bytes (104857600 = 100MB)

# Argumentos gen√©ricos JSON para fila e exchange (configura√ß√µes avan√ßadas)
# GLOBAL_RABBITMQ_QUEUE_ARGUMENTS={"x-overflow":"reject-publish","x-queue-master-locator":"min-masters"}
# GLOBAL_RABBITMQ_EXCHANGE_ARGUMENTS={}

# Individual RabbitMQ defaults (used when a user does not override the scaling knobs)
RABBITMQ_CONNECTION_POOL_SIZE=50
RABBITMQ_WORKER_COUNT=100
RABBITMQ_QUEUE_BUFFER_SIZE=100000
RABBITMQ_BATCH_SIZE=1000
RABBITMQ_BATCH_TIMEOUT_MS=100
RABBITMQ_PUBLISH_TIMEOUT_MS=5000
RABBITMQ_MAX_RETRIES=5
RABBITMQ_RETRY_DELAY_MS=500

# =================== TRACING CONFIGURATION (OpenTelemetry + Jaeger) ===================
# Enable/disable distributed tracing
TRACING_ENABLED=false
# Jaeger endpoint for OTLP HTTP traces
JAEGER_ENDPOINT=http://localhost:14268/api/traces
# Sampling ratio (0.0 to 1.0) - 0.1 = 10% of requests
JAEGER_SAMPLING_RATIO=0.1
# Service identification
TRACING_SERVICE_NAME=zuckzapgo
TRACING_SERVICE_VERSION=v1.5.0
# Environment (development, staging, production)
TRACING_ENVIRONMENT=development

# =================== MONITORING CONFIGURATION (Sentry) ===================
# Enable/disable error monitoring
SENTRY_ENABLED=false
# Sentry DSN (get from Sentry project settings)
SENTRY_DSN=
# Environment for error grouping
SENTRY_ENVIRONMENT=development
# Error sampling rate (0.0 to 1.0) - 1.0 = 100% of errors
SENTRY_SAMPLE_RATE=1.0
# Performance monitoring sample rate
SENTRY_TRACES_SAMPLE_RATE=0.1
# Profiling sample rate (requires traces)
SENTRY_PROFILES_SAMPLE_RATE=0.1

# =================== METRICS CONFIGURATION (Prometheus) ===================
PROMETHEUS_ENABLED=false
PROMETHEUS_METRICS_PATH=/metrics

# Additional metrics configuration
METRICS_COLLECTION_INTERVAL=30s
BUFFER_METRICS_ENABLED=true
TRANSPORT_METRICS_ENABLED=true

# =================== GLOBAL EVENT PIPELINE ===================
# Common buffer configuration
#  - GLOBAL_EVENT_BUFFER_USE_DATABASE: habilita buffer persistente em PostgreSQL/MySQL
#  - GLOBAL_EVENT_BUFFER_VISIBILITY_TIMEOUT: lease para eventos dequeued (ex.: "45s")
#  - GLOBAL_EVENT_BUFFER_RETRY_BASE / MAX: janela de backoff exponencial
#  - GLOBAL_EVENT_BUFFER_MAX_ATTEMPTS: n√∫mero m√°ximo de tentativas antes de DLQ
GLOBAL_EVENT_BUFFER_USE_DATABASE=true
GLOBAL_EVENT_BUFFER_VISIBILITY_TIMEOUT=60s
GLOBAL_EVENT_BUFFER_RETRY_BASE=5s
GLOBAL_EVENT_BUFFER_RETRY_MAX=2m
GLOBAL_EVENT_BUFFER_MAX_ATTEMPTS=12

# Archiving behavior
# GLOBAL_EVENT_BUFFER_ARCHIVE_SUCCESS controla o arquivamento de entregas bem-sucedidas no events_archive.
# true  = arquiva sucessos (status='success') e DLQ (status='dlq')
# false = N√ÉO arquiva sucessos; apenas DLQ continua sendo armazenado normalmente
GLOBAL_EVENT_BUFFER_ARCHIVE_SUCCESS=false

# Batching e circuit breaker do dispatcher
GLOBAL_EVENT_BATCH_SIZE=10
GLOBAL_EVENT_BATCH_TIMEOUT=500ms
GLOBAL_EVENT_CIRCUIT_MAX_FAILURES=5
GLOBAL_EVENT_CIRCUIT_RESET=30s
GLOBAL_EVENT_CIRCUIT_COOLDOWN=2s
GLOBAL_SKIP_CACHE_TTL=60s

# Configura√ß√£o do buffer em banco (PostgreSQL/MySQL)
GLOBAL_EVENT_BUFFER_RETENTION_DAYS=7
GLOBAL_EVENT_BUFFER_ARCHIVE_RETENTION_DAYS=30
GLOBAL_EVENT_BUFFER_PRUNE_INTERVAL=1h
GLOBAL_EVENT_BUFFER_PRUNE_BATCH_SIZE=1000
GLOBAL_EVENT_BUFFER_AUTO_PARTITION=false
GLOBAL_EVENT_BUFFER_PARTITION_RETENTION_MONTHS=6

# Legado: buffer SQLite (desabilitado em produ√ß√£o)
# GLOBAL_EVENT_BUFFER_PATH=./data/buffer/global-events.db
# GLOBAL_EVENT_BUFFER_ARCHIVE_RETENTION=0
# GLOBAL_EVENT_BUFFER_ARCHIVE_MAX_ROWS=0
# GLOBAL_EVENT_BUFFER_ARCHIVE_PRUNE_EVERY=1000
# GLOBAL_EVENT_BUFFER_WAL_CHECKPOINT=5000

# Graceful shutdown configuration
SHUTDOWN_GRACE_PERIOD=120s

# =================== EVENT MONITORING SSE CONFIGURATION ===================
# Enable real-time event monitoring via Server-Sent Events
MONITORING_ENABLED=false
# Maximum concurrent SSE clients connected
MONITORING_MAX_CLIENTS=100
# SSE heartbeat interval (keep-alive)
MONITORING_HEARTBEAT_INTERVAL=30s
# Event notification buffer size
MONITORING_EVENT_BUFFER_SIZE=10000
# Number of worker goroutines processing events
MONITORING_WORKER_COUNT=5
# Memory cache TTL for query results
MONITORING_CACHE_TTL=5m
# Cache cleanup interval (removes expired entries)
MONITORING_CACHE_CLEANUP_INTERVAL=1m
# Session token TTL (for SSE authentication)
MONITORING_SESSION_TOKEN_TTL=5m
# Maximum events per page for history endpoint
MONITORING_MAX_PAGE_SIZE=1000
# Default page size for history endpoint
MONITORING_DEFAULT_PAGE_SIZE=100
# Enable/disable persistence for monitoring events (set to false to keep only in-memory stream)
MONITORING_STORAGE_ENABLED=true
# Retention window (in days) for monitoring_events table when storage is enabled
MONITORING_RETENTION_DAYS=7
# Interval between automatic prune runs (e.g. 12h, 24h)
MONITORING_PRUNE_INTERVAL=24h
# Absolute base URL returned in stream_url (leave empty to fall back to ZUCKZAPGO_ADDRESS or http://localhost:<port>)
MONITORING_STREAM_BASE_URL=http://localhost:8080

# # =================== SQLITE CONFIGURATION ===================
# # SQLite buffer system configuration (applies to persistent event buffer AND users.db)
# # Connection pool settings
# # CRITICAL: Use 1 connection for SQLite WAL mode to prevent SQLITE_BUSY errors
# # SQLite allows 1 writer + unlimited readers, but Go's connection pool can cause write conflicts
# # For high-load scenarios, consider migrating to PostgreSQL instead of increasing these values
# SQLITE_MAX_OPEN_CONNS=1
# SQLITE_MAX_IDLE_CONNS=1
# # Busy timeout in milliseconds (prevents "database is locked" errors)
# SQLITE_BUSY_TIMEOUT_MS=10000
# # Cache size in KB (negative value = KB, positive = pages)
# SQLITE_CACHE_SIZE_KB=-64000
# # Journal mode: WAL (recommended), DELETE, TRUNCATE, PERSIST, MEMORY, OFF
# SQLITE_JOURNAL_MODE=WAL
# # Synchronous mode: OFF, NORMAL (recommended), FULL, EXTRA
# SQLITE_SYNCHRONOUS=NORMAL
# # Temp store: DEFAULT, FILE, MEMORY (recommended)
# SQLITE_TEMP_STORE=MEMORY
# # Memory-mapped I/O size in bytes (0 to disable)
# SQLITE_MMAP_SIZE_BYTES=268435456
# # Page size in bytes (must be power of 2 between 512 and 65536)
# SQLITE_PAGE_SIZE=8192
# # WAL auto-checkpoint interval in pages
# SQLITE_WAL_AUTO_CHECKPOINT=1000

# # WhatsApp Session Store SQLite configuration (separate from buffer)
# # Busy timeout for session database
# WA_SESSION_SQLITE_BUSY_TIMEOUT_MS=10000
# # Journal mode for session database
# WA_SESSION_SQLITE_JOURNAL_MODE=WAL
# # Synchronous mode for session database
# WA_SESSION_SQLITE_SYNCHRONOUS=NORMAL
# # Cache size for session database
# WA_SESSION_SQLITE_CACHE_SIZE_KB=-64000
